# PDF2Excel è‡ªåŠ¨åŒ–å›å½’æµ‹è¯•æŒ‡å—

æœ¬æ–‡æ¡£ç”¨äºæŒ‡å¯¼å¼€å‘è€…å¦‚ä½•ä½¿ç”¨ã€ç»´æŠ¤å’Œæ‰©å±•é¡¹ç›®çš„å›å½’æµ‹è¯•å¥—ä»¶ã€‚å›å½’æµ‹è¯•çš„ç›®çš„æ˜¯ç¡®ä¿ä»£ç ä¿®æ”¹ï¼ˆå¦‚æ­£åˆ™ä¼˜åŒ–ã€æ¨¡å‹åˆ‡æ¢ï¼‰ä¸ä¼šç ´åå·²æœ‰çš„æ­£ç¡®åŠŸèƒ½ã€‚

## ğŸ“‚ ç›®å½•ç»“æ„

```
test/regression/
â”œâ”€â”€ cases/                  # [æ ¸å¿ƒ] æµ‹è¯•ç”¨ä¾‹åº“
â”‚   â”œâ”€â”€ zhejiang/           # æµ™æ±Ÿç»„ç”¨ä¾‹ (å›¾ç‰‡ + Excel + MD)
â”‚   â”œâ”€â”€ anhui_physics/      # å®‰å¾½ç‰©ç†ç»„ç”¨ä¾‹
â”‚   â””â”€â”€ anhui_history/      # å®‰å¾½å†å²ç»„ç”¨ä¾‹
â”œâ”€â”€ output/                 # [ä¸´æ—¶] æµ‹è¯•è¿è¡Œäº§ç”Ÿçš„å®é™…è¾“å‡º
â”œâ”€â”€ README.md               # æœ¬æ–‡æ¡£
â””â”€â”€ (scripts/run_regression_test.py) # æ‰§è¡Œè„šæœ¬
```

æ¯ä¸ªç”¨ä¾‹åŒ…å«ä¸‰ä¸ªé…å¥—æ–‡ä»¶ï¼š
1.  **è¾“å…¥å›¾ç‰‡**: `page_XXX.png`
2.  **åŸºå‡†æ•°æ®**: `page_XXX.xlsx` (Ground Truth)
3.  **åŸå§‹æ–‡æœ¬**: `page_XXX.md` (ç”¨äºæ ¡å¯¹çš„åŸå§‹MDæ–‡æœ¬)

---

## ğŸš€ å¦‚ä½•è¿è¡Œæµ‹è¯•

### 1. å…¨é‡å›å½’æµ‹è¯•
é‡æ–°è°ƒç”¨ API å¹¶å¯¹æ¯”ï¼š
```bash
./venv/bin/python scripts/run_regression_test.py --model ocr
```

### 2. ä»…å¯¹æ¯”æ¨¡å¼ (å¿«é€ŸéªŒè¯) ğŸŒŸ
**ä¸è°ƒç”¨ API**ï¼Œç›´æ¥å¯¹æ¯” `output` ç›®å½•ä¸‹å·²æœ‰çš„ç»“æœï¼š
```bash
./venv/bin/python scripts/run_regression_test.py --compare-only
```

### 3. å•ä¸ªç”¨ä¾‹ç²¾å‡†è°ƒè¯•
```bash
# åªæµ‹ç‰¹å®šé¡µé¢ï¼ŒæŒ‡å®šæ¨¡å‹
./venv/bin/python scripts/run_regression_test.py --case page_005 --model ocr
```

---

## â• å¦‚ä½•æ–°å¢/æ›´æ–°æµ‹è¯•ç”¨ä¾‹

### æ­¥éª¤ 1: å‡†å¤‡æ•°æ®
åœ¨æ­£å¸¸ç”Ÿäº§æˆ–æµ‹è¯•è¿è¡Œåï¼Œç¡®è®¤ `output` ç›®å½•ä¸‹ç”Ÿæˆçš„ `page_XXX.xlsx` å’Œ `page_XXX.md` æ˜¯**å®Œå…¨æ­£ç¡®**çš„ã€‚

### æ­¥éª¤ 2: åŒæ­¥åˆ°æµ‹è¯•åº“
å°†è¿™ä¸¤ä¸ªæ–‡ä»¶æˆå¯¹å¤åˆ¶åˆ° `test/regression/cases/{province}/` ä¸‹ï¼Œå¹¶é‡å‘½åï¼ˆå»æ‰æ—¶é—´æˆ³ï¼‰ï¼š

```bash
# ç¤ºä¾‹ï¼šå°†ç‰©ç†ç»„ page_088 å­˜å…¥åŸºå‡†åº“
cp output/anhui_physics/page_088_20260125.xlsx test/regression/cases/anhui_physics/page_088.xlsx
cp output/anhui_physics/page_088_20260125.md   test/regression/cases/anhui_physics/page_088.md
```

### æ­¥éª¤ 3: éªŒè¯
```bash
./venv/bin/python scripts/run_regression_test.py --province anhui_physics --case page_088 --compare-only
```

---

## âš ï¸ è‡ªåŠ¨åŒ–æ¯”å¯¹é€»è¾‘è¯´æ˜

æ¯”å¯¹è„šæœ¬å†…ç½®äº†ä»¥ä¸‹**æŠ—å¹²æ‰°é€»è¾‘**ï¼Œä»¥åº”å¯¹ OCR çš„ä¸ç¨³å®šæ€§ï¼š
*   âœ… **ç¬¦å·å¿½ç•¥**: è‡ªåŠ¨å¿½ç•¥å…¨è§’/åŠè§’ï¼ˆå¦‚ `(` vs `ï¼ˆ`ï¼‰çš„å·®å¼‚ã€‚
*   âœ… **ç©ºæ ¼æ¸…æ´—**: è‡ªåŠ¨ç§»é™¤ä¸­æ–‡å­—ç¬¦ã€æ•°å­—ã€æ ‡ç‚¹ç¬¦å·ä¹‹é—´çš„éšæœºç©ºæ ¼ã€‚
*   âœ… **ç»“æ„æ ¡éªŒ**: ä¸¥æ ¼æ ¡éªŒè¡Œåºå’Œè¡Œæ•°ã€‚å¦‚æœå‡ºç°è¡Œé”™ä½ï¼Œæµ‹è¯•å°†å¤±è´¥ã€‚