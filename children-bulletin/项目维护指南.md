# 儿童英语小报 - 项目维护指南

## 一、项目结构概览

```
children-bulletin/
├── themes.json              # 主题数据（核心文件）
├── titles.json              # 标题配置
├── js/
│   ├── store.js            # 状态管理
│   ├── components/
│   │   ├── theme-selector.js    # 主题选择组件
│   │   └── vocabulary-editor.js # 词汇编辑组件
│   └── modern-main.js      # 主入口
└── index.html              # 主页面
```

## 二、核心数据结构

### 1. 主题结构 (themes.json)

```json
{
  "themes": [
    {
      "id": "unique-id",
      "name": "主题名称",
      "icon": "🏠",
      "description": "主题描述",
      "scenes": [
        {
          "id": "scene-id",
          "name": "场景名称",
          "vocabulary": [
            {
              "english": "单词",
              "chinese": "中文翻译",
              "phonetic": "音标",
              "category": "character|object|environment|action"
            }
          ]
        }
      ]
    }
  ]
}
```

### 2. 词汇分类说明

- **character**: 人物角色（如：teacher, student, doctor）
- **object**: 物品工具（如：book, chair, computer）
- **environment**: 环境设施（如：school, park, hospital）
- **action**: 动作行为（如：run, jump, read）

## 三、维护操作指南

### 1. 主题管理

#### 添加新主题

1. 打开 `themes.json` 文件
2. 在 `themes` 数组中添加新主题对象
3. 确保每个字段完整：
   ```json
   {
     "id": "nature",
     "name": "自然风光",
     "icon": "🌳",
     "description": "探索大自然的美景",
     "scenes": []
   }
   ```

#### 修改现有主题

- 直接编辑对应主题的属性
- 保持 ID 不变，只修改名称、图标或描述

### 2. 场景管理

#### 添加新场景到主题

```json
{
  "id": "beach",
  "name": "海滩",
  "vocabulary": [
    {
      "english": "wave",
      "chinese": "波浪",
      "phonetic": "weɪv",
      "category": "environment"
    }
  ]
}
```

### 3. 词汇管理

#### 添加新词汇

每个词汇必须包含以下字段：
- `english`: 英文单词（必填）
- `chinese`: 中文翻译（必填）
- `phonetic`: 国际音标（必填）
- `category`: 词汇分类（必填）

#### 音标规范

- 使用国际音标 (IPA) 标准
- 包含重音符号（如：ˈ, ˌ）
- 注意区分英式和美式发音
- 使用斜杠包围：`/həˈləʊ/`

示例：
```json
{
  "english": "beautiful",
  "chinese": "美丽的",
  "phonetic": "ˈbjuːtɪfl",
  "category": "object"
}
```

## 四、维护工具和脚本

### 1. 数据验证脚本

创建 `scripts/vocabulary-validator.js`：

```javascript
function validateVocabulary(themes) {
  const errors = [];
  const warnings = [];

  themes.forEach(theme => {
    // 验证主题必填字段
    if (!theme.id || !theme.name || !theme.icon) {
      errors.push(`主题 ${theme.name} 缺少必填字段`);
    }

    theme.scenes.forEach(scene => {
      scene.vocabulary.forEach(word => {
        // 验证词汇必填字段
        if (!word.english || !word.chinese || !word.phonetic) {
          errors.push(`词汇缺失: ${theme.name} - ${scene.name} - ${word.english || '未知'}`);
        }

        // 验证音标格式
        if (!word.phonetic.match(/^\/[^\/]+\/$/)) {
          warnings.push(`音标格式可能有误: ${word.english} - ${word.phonetic}`);
        }

        // 验证分类
        const validCategories = ['character', 'object', 'environment', 'action'];
        if (!validCategories.includes(word.category)) {
          warnings.push(`词汇分类无效: ${word.english} - ${word.category}`);
        }
      });
    });
  });

  return { errors, warnings };
}

// 使用示例
const fs = require('fs');
const themes = JSON.parse(fs.readFileSync('../themes.json', 'utf8'));
const result = validateVocabulary(themes.themes);

if (result.errors.length > 0) {
  console.error('发现错误:');
  result.errors.forEach(err => console.error('- ' + err));
}

if (result.warnings.length > 0) {
  console.warn('发现警告:');
  result.warnings.forEach(warn => console.warn('- ' + warn));
}
```

### 2. 批量导入脚本

创建 `scripts/import-vocabulary.js`：

```javascript
function csvToJson(csvData) {
  const lines = csvData.split('\n');
  const headers = lines[0].split(',');

  return lines.slice(1).map(line => {
    const values = line.split(',');
    const obj = {};

    headers.forEach((header, index) => {
      obj[header.trim()] = values[index]?.trim() || '';
    });

    // 默认分类为 object
    if (!obj.category) {
      obj.category = 'object';
    }

    return obj;
  }).filter(word => word.english); // 过滤空行
}

function importVocabularyToTheme(themeId, sceneId, vocabulary) {
  const fs = require('fs');
  const themes = JSON.parse(fs.readFileSync('../themes.json', 'utf8'));

  const theme = themes.themes.find(t => t.id === themeId);
  if (!theme) {
    throw new Error(`主题 ${themeId} 不存在`);
  }

  const scene = theme.scenes.find(s => s.id === sceneId);
  if (!scene) {
    throw new Error(`场景 ${sceneId} 不存在`);
  }

  // 合并词汇，避免重复
  const existingWords = new Set(scene.vocabulary.map(v => v.english));
  const newWords = vocabulary.filter(v => !existingWords.has(v.english));

  scene.vocabulary.push(...newWords);

  // 保存文件
  fs.writeFileSync('../themes.json', JSON.stringify(themes, null, 2));

  console.log(`成功导入 ${newWords.length} 个新词汇`);
}

// 使用示例
// const csvData = `english,chinese,phonetic,category
// apple,苹果,ˈæpl,object
// banana,香蕉,bəˈnɑːnə,object`;
// const vocabulary = csvToJson(csvData);
// importVocabularyToTheme('daily-life', 'home', vocabulary);
```

### 3. 数据导出脚本

创建 `scripts/export-vocabulary.js`：

```javascript
function exportVocabulary(themeId = null, sceneId = null) {
  const fs = require('fs');
  const themes = JSON.parse(fs.readFileSync('../themes.json', 'utf8'));

  let vocabulary = [];

  if (themeId && sceneId) {
    // 导出特定主题场景的词汇
    const theme = themes.themes.find(t => t.id === themeId);
    if (theme) {
      const scene = theme.scenes.find(s => s.id === sceneId);
      vocabulary = scene ? scene.vocabulary : [];
    }
  } else {
    // 导出所有词汇
    themes.themes.forEach(theme => {
      theme.scenes.forEach(scene => {
        scene.vocabulary.forEach(word => {
          vocabulary.push({
            ...word,
            theme: theme.name,
            scene: scene.name
          });
        });
      });
    });
  }

  // 导出为 CSV
  const csv = [
    'theme,scene,english,chinese,phonetic,category',
    ...vocabulary.map(v =>
      `${v.theme || ''},${v.scene || ''},${v.english},${v.chinese},${v.phonetic},${v.category}`
    )
  ].join('\n');

  fs.writeFileSync(`vocabulary_export_${Date.now()}.csv`, csv);
  console.log(`导出完成，共 ${vocabulary.length} 个词汇`);
}
```

## 五、版本控制和备份

### 1. Git 工作流

```bash
# 创建维护分支
git checkout -b maintenance/update-vocabulary

# 提交更改
git add themes.json
git commit -m "feat: 添加新主题 - 自然风光"

# 推送并创建 PR
git push origin maintenance/update-vocabulary
```

### 2. 备份策略

- **每日备份**: 自动备份 `themes.json` 到 `backups/daily/`
- **版本备份**: 每次重大更新前手动备份
- **云端同步**: 使用 GitHub/GitLab 进行远程备份

## 六、质量保证清单

### 1. 词汇审核清单

- [ ] 英文单词拼写正确
- [ ] 中文翻译准确自然
- [ ] 音标符合国际标准
- [ ] 词汇分类合理
- [ ] 无重复词汇
- [ ] 适合儿童学习难度

### 2. 主题审核清单

- [ ] 主题名称通俗易懂
- [ ] 图标形象贴切
- [ ] 描述清晰准确
- [ ] 场景设置合理
- [ ] 词汇数量适中（建议每个场景 15-30 个词汇）

## 七、常见问题处理

### 1. 音标格式问题

**问题**: 音标显示不正确
**解决**:
- 确保使用斜杠包围
- 使用 Unicode 字符
- 参考剑桥词典或牛津词典

### 2. 重复词汇

**问题**: 同一场景出现重复词汇
**解决**: 使用验证脚本自动检测并去重

### 3. 分类错误

**问题**: 词汇分类不准确
**解决**:
- 制定明确的分类标准
- 定期审核分类规则
- 收集反馈并调整

## 八、扩展性考虑

### 1. 未来功能扩展

- 支持词汇难度级别标记
- 添加例句和用法说明
- 支持单词发音音频
- 添加词汇图片
- 实现智能学习路径

### 2. 数据库迁移计划

当数据量增大时，可考虑迁移到数据库：

```javascript
// 示例：迁移到 MongoDB
const vocabularySchema = new mongoose.Schema({
  english: String,
  chinese: String,
  phonetic: String,
  category: String,
  theme: { type: Schema.Types.ObjectId, ref: 'Theme' },
  scene: { type: Schema.Types.ObjectId, ref: 'Scene' },
  difficulty: Number, // 1-5 级
  examples: [String], // 例句
  audioUrl: String,   // 发音音频
  imageUrl: String    // 配图
});
```

## 九、维护日程建议

### 每日
- 检查用户反馈
- 修复报告的错误

### 每周
- 审核新添加的词汇
- 更新热门主题词汇

### 每月
- 数据备份检查
- 词汇准确性抽查
- 性能优化评估

### 每季度
- 添加新主题/场景
- 全面数据审核
- 用户满意度调研

### 每年
- 数据架构评估
- 技术栈升级
- 重大功能规划

## 十、联系方式和支持

如有问题或建议，请通过以下方式联系：
- 创建 GitHub Issue
- 发送邮件至维护团队
- 参与社区讨论

---

*最后更新: 2025-12-17*