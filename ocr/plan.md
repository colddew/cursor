# OCR 项目执行计划

## 项目目标

将招生计划书图片识别并转换为 Excel 表格。

**核心原则：**
- 稳定性 > 效率
- 不能牺牲准确性
- 不能降低模型版本（底线：gemini-3-flash）

---

## 当前状态

### 调用方式（已验证）

| 方式            | 配置                       | 模型                   | 耗时   | 稳定性 | 推荐度 |
| --------------- | -------------------------- | ---------------------- | ------ | ------ | ------ |
| **Antigravity** | `http://127.0.0.1:8045/v1` | gemini-3-flash         | ~2分   | ✅      | ⭐⭐⭐    |
| **Gemini CLI**  | 登录凭证 + 代理            | gemini-3-flash-preview | ~2-3分 | ⚠️      | ⭐⭐     |

**推荐使用 Antigravity**（更稳定）

### 提示词

| 提示词              | 状态         |
| ------------------- | ------------ |
| `simple_prompt.md`  | 待进一步测试 |
| `visual_prompt.md`  | 待进一步测试 |
| `complex_prompt.md` | 作为参考     |

---

## 规划

### 阶段一：确认稳定性（延后）

**暂时不执行稳定性测试。**

原因：
- 当前测试结果已满足需求
- 后续实际使用时再验证

### 阶段二：效率优化（延后）

**当前目标：单页耗时 2-3 分钟，300-500 页总耗时 2-3 小时，可接受。**

**优化方向（暂不执行）：**
- 并行处理（代理问题，antigravity 可能不支持）
- 提示词精简（保持当前规则，先保证稳定）
- 更快的模型（gemini-flash-latest、gemini-2.5-flash）- 可能牺牲准确性，不尝试

### 阶段三：复杂场景测试

**后续会使用更复杂的图片进行测试：**
- 文字与表格混排的文档
- 多栏布局
- 跨页表格
- 包含页眉页脚水印等干扰元素

**目的：**
- 验证当前提示词在复杂场景下的表现
- 评估是否需要调整提示词规则

### 阶段四：成本优化（延后）

- GCC 绑定信用卡提升配额
- 评估 antigravity 成本

---

## 待办事项

### 高优先级
- [ ] 使用 Antigravity + visual_prompt.md 测试安徽图片（验证稳定性）
- [ ] 使用 Antigravity + visual_prompt.md 测试浙江图片（验证稳定性）

### 中优先级
- [ ] 测试 300-500 页批量处理效率
- [ ] 预估总耗时

### 低优先级（延后）
- [ ] 稳定性测试（10次×2提示词）
- [ ] 并行处理方案设计
- [ ] GCC 绑定信用卡提升配额
- [ ] 本地部署大模型调研（独立项目）

---

### 运行方式

```bash
# Antigravity（推荐）
cd /tmp
python3 scripts/antigravity/antigravity_tools_api_table_converter.py \
    test_images/anhui_sample.jpg \
    prompt/visual_prompt.md
```

---

## 注意事项

1. **国内网络** - Gemini CLI 需配置代理
2. **Antigravity 代理** - 需保持本地服务运行（端口 8045）
3. **模型底线** - gemini-3-flash，不能降级
4. **准确性优先** - 不接受牺牲准确性换取速度
